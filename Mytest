jobs:
  deploy:
    runs-on: ubuntu-latest
    steps:
      - name: Set environment-specific variables
        run: |
          # Dynamically construct environment-specific variable names
          KUBE_URL_VAR="KUBE_${{ env.ENVIRONMENT }}_URL"
          KUBE_USER_VAR="KUBE_${{ env.ENVIRONMENT }}_USER"
          KUBE_PASSWORD_VAR="KUBE_${{ env.ENVIRONMENT }}_PASSWORD"

          # Export the actual values of the environment-specific variables
          echo "KUBE_URL=${{ vars[$KUBE_URL_VAR] }}" >> $GITHUB_ENV
          echo "KUBE_USER=${{ vars[$KUBE_USER_VAR] }}" >> $GITHUB_ENV
          echo "KUBE_PASSWORD=${{ secrets[$KUBE_PASSWORD_VAR] }}" >> $GITHUB_ENV

      - name: Use dynamic environment variables
        run: |
          echo "Cluster URL: $KUBE_URL"
          echo "Service Account Name: $KUBE_USER"
          echo "Service Account Password: $KUBE_PASSWORD"
